function countColorCellsByCell(range, colorCell) {
  // 背景色を取得
  const targetColor = colorCell.getBackground();
  const backgrounds = range.getBackgrounds();

  // 一致カウント
  let count = 0;
  for (let row of backgrounds) {
    for (let color of row) {
      if (color.toLowerCase() === targetColor.toLowerCase()) {
        count++;
      }
    }
  }

  return count;
}
