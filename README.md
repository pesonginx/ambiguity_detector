# 質問文の曖昧さ検出システム

このシステムは、コールセンターに寄せられる質問文の曖昧さを数値化するツールです。WordNetと形態素解析を組み合わせて、文章の曖昧さをスコア化します。

## 処理の流れ

### 1. 前準備
- NLTKの必要なデータをダウンロード
  - `punkt`: トークン化に必要なデータ
  - `averaged_perceptron_tagger`: 品詞タグ付けに必要なデータ
  - `wordnet`: 英語のWordNet辞書
  - `omw-1.4`: 多言語WordNet（日本語対応）
  - `maxent_ne_chunker`: 固有表現抽出に必要なデータ
  - `words`: 固有表現抽出に必要なデータ

### 2. 形態素解析
- Janomeを使用して質問文を単語に分解
- 各単語の表層形（surface）を取得

### 3. 曖昧さスコアの計算
各質問文に対して、以下の3つの指標を組み合わせて曖昧さスコアを計算：

1. **平均的な意味の数** (重み: 0.4)
   - 各単語が持つ意味の数の平均値
   - 例：「銀行」は「金融機関」と「川の土手」の2つの意味を持つ

2. **意味の数の分散** (重み: 0.3)
   - 単語ごとの意味の数のばらつき
   - 意味の数に大きな差があるほど、曖昧さが高いと判断

3. **多義語の割合** (重み: 0.3)
   - 2つ以上の意味を持つ単語の割合
   - 例：10個の単語中3個が多義語の場合、割合は0.3

### 4. スコアの計算式
```
曖昧さスコア = (平均的な意味の数 × 0.4) + (意味の数の分散 × 0.3) + (多義語の割合 × 0.3)
```

### 5. 出力
- 入力Excelファイルから質問文を読み込み
- 各質問文の曖昧さスコアを計算
- 結果を新しいExcelファイルに出力
  - 列：「質問文」「曖昧スコア」

## スコアの解釈
- スコアは0以上の数値
- スコアが高いほど、その質問文は曖昧である可能性が高い
- スコアの重み付けは調整可能（現在は0.4:0.3:0.3）

## 使用例
入力：
```
質問文
「銀行の近くのコンビニはどこですか？」
「この商品の使い方を教えてください」
```

出力：
```
質問文,曖昧スコア
「銀行の近くのコンビニはどこですか？,0.523
「この商品の使い方を教えてください,0.876
```

## 注意点
- WordNetに登録されていない単語はスコア計算から除外
- カタカナは自動的にひらがなに変換して検索
- スコアは相対的な指標であり、絶対的な曖昧さを表すものではない 